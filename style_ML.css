/* ======= style_ML.css — v14 ======= */
/* Enfocado en forzar estética del sidebar y ajustar buscador. */

:root{
  --ml-sidebar-w: 260px;
  --ml-gap: 16px;
  --ml-card-radius: 14px;
  --ml-card-pad: 12px 14px;
  --ml-blue-text: #0e2a7b;      /* texto modo claro */
  --ml-accent: #0D2C7A;         /* borde activo modo claro */
  --ml-light-bg: #C7E0FF;       /* fondo tarjeta clara */
  --ml-light-border: #9CC5FF;
  --ml-light-ring: rgba(13,44,122,.45);
  --ml-dark-bg: #0f1729;        /* fondo tarjeta oscura */
  --ml-dark-border: #26324a;
  --ml-dark-ring: rgba(255,255,255,.55);
}

body.ml-wide{ overflow-x:hidden; }
body.ml-wide .container, body.ml-wide .content, body.ml-wide .wrapper,
body.ml-wide .page, body.ml-wide .site-main, body.ml-wide main, body.ml-wide .main{
  max-width: 1440px !important;
  margin-left: auto; margin-right: auto;
}

.ml-layout{ display:grid; grid-template-columns:minmax(240px,var(--ml-sidebar-w)) 1fr; gap:var(--ml-gap); align-items:start; }

#ml-sidebar{
  position: sticky;
  top: var(--ml-sticky-offset, 72px);
  height: calc(100vh - var(--ml-sticky-offset, 72px) - 16px);
  overflow-y: auto; overflow-x: hidden;
  -webkit-overflow-scrolling: touch; overscroll-behavior: contain;
  padding-right: 2px;
}

/* Línea divisoria animada para buscadores */
#module-searchbar::after,
#tools-searchbar::after,
#glossary-searchbar::after {
  content: "";
  display: block;
  height: 3px;
  background: linear-gradient(90deg, #a3d5ff, #1e90ff, #a3d5ff);
  background-size: 200% 100%;
  animation: moveLine 6s linear infinite;
  border-radius: 2px;
  margin-top: 6px;
}

@keyframes moveLine {
  0%   { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}


/* quitar título lateral */
#ml-sidebar .ml-title{ display:none !important; }

#ml-nav{ display:grid; gap:10px; padding-top:2px; }

/* Estado activo por clase .ml-active (borde sin cambiar el fondo) */
#ml-sidebar #ml-nav a.ml-card.ml-active{
  outline: 3px solid var(--ml-accent);
  outline-offset: 2px;
  box-shadow: none !important;
  border-color: var(--ml-accent) !important;
}
/* Dark: borde blanco */
#ml-sidebar.ml-theme-dark #ml-nav a.ml-card.ml-active{
  outline: 3px solid #ffffff;
  border-color: #ffffff !important;
}

/* Buscador: dejar a mitad de ancho y botón cerca */
.ml-search-compact{ flex:0 0 50% !important; width:50% !important; max-width:520px !important; display:inline-block !important; vertical-align:middle; }
.ml-clear-btn{ margin-left: 8px !important; vertical-align: middle; }

/* Resultado resaltado en contenido */
@keyframes mlHitPulse { 0%{box-shadow:0 0 0 0 rgba(13,44,122,.48);} 60%{box-shadow:0 0 0 8px rgba(13,44,122,.30);} 100%{box-shadow:0 0 0 0 rgba(13,44,122,0);} }
.ml-hit{ outline: 3px solid var(--ml-accent); outline-offset: 2px; animation: mlHitPulse 1.2s ease; background-color: #FFF6CC !important; }
#ml-sidebar.ml-theme-dark ~ .ml-main .ml-hit{ outline-color:#ffffff; background-color: rgba(255,255,255,.10) !important; }

/* ===== style_ML.css — v16 cards fix ===== */
:root{
  --ml-card-radius: 14px;
  --ml-card-pad: 12px 14px;
  --ml-blue-text: #0E2A7B;
  --ml-light-bg: #C7E0FF;
  --ml-light-border: #9CC5FF;
  --ml-accent: #0D2C7A;
  --ml-dark-bg: #0f1729;
  --ml-dark-border: #26324a;
}

#ml-nav{ display:grid; gap:10px; }

/* Tarjetas (modo claro) */
#ml-sidebar #ml-nav a.ml-card{
  display:block;
  box-sizing:border-box;
  padding: var(--ml-card-pad);
  border-radius: var(--ml-card-radius);
  border: 1px solid var(--ml-light-border) !important;
  background: var(--ml-light-bg) !important;
  color: var(--ml-blue-text) !important;
  text-decoration: none !important;
  font-weight: 700;
  line-height: 1.25;
  transition: box-shadow .12s ease, transform .12s ease, border-color .12s ease;
}
#ml-sidebar #ml-nav a.ml-card:hover{
  transform: translateY(-1px);
  box-shadow: 0 6px 18px rgba(0,0,0,.08);
}
#ml-sidebar #ml-nav a.ml-card.ml-active,
#ml-sidebar #ml-nav a.ml-card[aria-current="true"]{
  outline: 3px solid var(--ml-accent);
  outline-offset: 2px;
  border-color: var(--ml-accent) !important;
}

/* Tarjetas (modo oscuro) */
.dark #ml-sidebar #ml-nav a.ml-card,
[data-theme="dark"] #ml-sidebar #ml-nav a.ml-card,
.modo-oscuro #ml-sidebar #ml-nav a.ml-card{
  background: var(--ml-dark-bg) !important;
  color: #fff !important;
  border-color: var(--ml-dark-border) !important;
}
.dark #ml-sidebar #ml-nav a.ml-card.ml-active,
[data-theme="dark"] #ml-sidebar #ml-nav a.ml-card.ml-active,
.modo-oscuro #ml-sidebar #ml-nav a.ml-card.ml-active{
  outline: 3px solid #fff;
  border-color: #fff !important;
}


/* === ML hotfix v16a: estilo sólido para las tarjetas del sidebar === */
#ml-nav a.ml-card{
  display:block;
  margin: 10px 0;
  padding:12px 14px;
  border-radius:14px;
  text-decoration:none !important;
  background:#0f1729;            /* oscuro por defecto */
  color:#ffffff !important;
  border:1px solid #26324a;
  line-height:1.25;
  font-weight:700;
}
/* Variante clara si el sitio usa body.light o data-theme=light */
body.light #ml-nav a.ml-card,
[data-theme="light"] #ml-nav a.ml-card{
  background:#C7E0FF;
  color:#0e2a7b !important;
  border-color:#9CC5FF;
}
/* Activa: borde marcado */
#ml-nav a.ml-card.ml-active{
  outline:3px solid #0D2C7A;
  outline-offset:2px;
  border-color:#0D2C7A;
}
/* Cuando el sitio esté en dark (clase .dark o data-theme) */
body.dark #ml-nav a.ml-card,
[data-theme="dark"] #ml-nav a.ml-card{
  background:#0f1729;
  color:#ffffff !important;
  border-color:#26324a;
}
body.dark #ml-nav a.ml-card.ml-active,
[data-theme="dark"] #ml-nav a.ml-card[aria-current="true"]{
  outline:3px solid #ffffff;
  border-color:#ffffff;
}


/* === ML v16b: restaurar MODO OSCURO (base claro + overrides dark) === */
/* Base: CLARO */
#ml-sidebar #ml-nav a.ml-card{
  display:block;
  margin:10px 0;
  padding:12px 14px;
  border-radius:14px;
  text-decoration:none !important;
  background:#C7E0FF;
  color:#0e2a7b !important;
  border:1px solid #9CC5FF;
  line-height:1.25;
  font-weight:700;
}
#ml-sidebar #ml-nav a.ml-card.ml-active{
  outline:3px solid #0D2C7A;
  outline-offset:2px;
  border-color:#0D2C7A;
}

/* Overrides: OSCURO */
/* Detectamos varios toggles comunes y agregamos fallback por clase en el propio sidebar */
html.dark #ml-sidebar #ml-nav a.ml-card,
body.dark #ml-sidebar #ml-nav a.ml-card,
[data-theme="dark"] #ml-sidebar #ml-nav a.ml-card,
.modo-oscuro #ml-sidebar #ml-nav a.ml-card,
#ml-sidebar.ml-theme-dark #ml-nav a.ml-card{
  background:#0f1729 !important;
  color:#ffffff !important;
  border-color:#26324a !important;
}
html.dark #ml-sidebar #ml-nav a.ml-card.ml-active,
body.dark #ml-sidebar #ml-nav a.ml-card.ml-active,
[data-theme="dark"] #ml-sidebar #ml-nav a.ml-card.ml-active,
.modo-oscuro #ml-sidebar #ml-nav a.ml-card.ml-active,
#ml-sidebar.ml-theme-dark #ml-nav a.ml-card.ml-active{
  outline:3px solid #ffffff !important;
  border-color:#ffffff !important;
}


/* === ML hotfix: Herramientas en 3 columnas fijas (desktop) === */
main .tool-card-grid,
#ml-main .tool-card-grid {
  display: grid !important;
  grid-template-columns: repeat(3, minmax(0, 1fr)) !important;
  gap: 1.5rem !important;
}
/* Responsivo: 2 columnas en tablets, 1 en móvil */
@media (max-width: 1100px){
  main .tool-card-grid,
  #ml-main .tool-card-grid {
    grid-template-columns: repeat(2, 1fr) !important;
  }
}
@media (max-width: 640px){
  main .tool-card-grid,
  #ml-main .tool-card-grid {
    grid-template-columns: 1fr !important;
  }
}



/* Compensación automática para títulos anclables */
h1[id], h2[id], h3[id], h4[id], section[id^="tools-"] {
  scroll-margin-top: calc(var(--nav-h, 60px) + var(--searchbar-h, 60px) + 12px);
}

/* ==== ML Divider v2 (absolute) ====
   Soluciona que ::after no se muestre por ser ítem flex.
   Pone una línea azul suave animada pegada al borde inferior del bloque del buscador,
   sin requerir JS. Aplica a módulos, herramientas y glosario. */
#module-searchbar, #tools-searchbar, #glossary-searchbar {
  position: sticky; /* ya está en la mayoría, lo reforzamos */
}

#module-searchbar::after,
#tools-searchbar::after,
#glossary-searchbar::after {
  content: "";
  position: absolute;
  left: 0;
  right: 0;
  bottom: -1px;             /* pegada al borde inferior */
  height: 3px;
  background: linear-gradient(90deg, #a3d5ff, #1e90ff, #a3d5ff);
  background-size: 200% 100%;
  animation: moveLine 6s linear infinite;
  border-radius: 2px;
  pointer-events: none;
  z-index: 1;
}

/* La animación ya existe más arriba; la dejamos aquí por si falta en algún build */
@keyframes moveLine {
  0%   { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* ==== ML Divider v3 (grey + spacing) ====
   - Agrega un pequeño espacio inferior al bloque del buscador
   - Línea gris sutil con animación suave, a ancho completo
*/
#module-searchbar, #tools-searchbar, #glossary-searchbar{
  padding-bottom: 8px !important;  /* separa la línea del input/botón */
  position: sticky;
}

#module-searchbar::after,
#tools-searchbar::after,
#glossary-searchbar::after{
  content:"";
  position:absolute; left:0; right:0; bottom:0;
  height: 2px;                           /* más sutil */
  background: linear-gradient(90deg, #e5e7eb, #9ca3af, #e5e7eb); /* gris claro -> medio -> claro */
  background-size: 200% 100%;
  animation: moveLine 8s linear infinite; /* un poco más lenta */
  border-radius: 2px;
  pointer-events:none;
  z-index:1;
}

/* ==== ML Clear Button v1 (gris + texto negro) ==== */
#module-clear.ml-clear-btn,
#module-clear,
.ml-clear-btn {
  background: #e5e7eb !important;    /* gris claro como la línea */
  color: #111111 !important;          /* letras negras */
  border: 1.5px solid #9ca3af !important;  /* gris medio */
  border-radius: 8px;
  padding: 8px 12px;
  font-weight: 600;
  box-shadow: none;
  transition: filter .15s ease, transform .05s ease, box-shadow .2s ease;
}

.ml-clear-btn:hover {
  filter: brightness(0.97);
}

.ml-clear-btn:active {
  transform: translateY(1px);
}

.ml-clear-btn:focus-visible {
  outline: 3px solid #9ca3af;
  outline-offset: 2px;
}
